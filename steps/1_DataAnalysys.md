# 導入
QRコードはテキスト文字列を符号化します。
QRコードの標準規格にはテキストを符号化するための4つのモードが存在します。
- 数字(numeric)
- 英数字(alphanumeric)
- バイト(byte)
- 漢字(Kanji)

各モードはビット文字列として符号化しますが、テキストをビットに変換する方法は各モードで異なります。
各変換方法は、使用するデータタイプの最小使用可能ビット文字列を生成するように最適化されています。
このページではどのように使用するモードを特定するのかを説明します。

# コンテンツ
- QRコードのモード
- 漢字モードについての注意
- UTF-8についての注意
- 最も効率的なモードの選択方法
- 複合モードと最適化
- サマリー
- 次のステップ


# QRコードのモード
各モードに含まれる文字の特徴は以下のとおりです。

|モード|含まれる文字|備考|
|---|---|---|
|Numeric mode|**0123456789**||
|Alphanumeric mode|***0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ$%*+-./:(スペース)***||
|Byte mode|**ISO-8859-1文字セット**|一部のQRコードスキャナは代わりにUTF-8がバイトモードで使用されているか検出できます。|
|Kanji mode|**Shift-JISの2バイト文字**|UTF-8は漢字を符号化できますが、3バイト、もしくは4バイトを使用する必要があります。Shift-JISはそれぞれの漢字を2バイトで符号化できます。漢字モードは漢字をより効率的に圧縮できます。テキスト全体がShift-JIS範囲の2バイト文字で構築されている場合、漢字モードを使用します。また、このページで説明するように同一QRコードで複合モードが使用可能です。|
|ECI mode|直接文字セットを指定します。|一部のQRコードスキャナはECIモードをサポートせず、これが使用されるQRコードを理解できないでしょう。|
|Structured Append mode||最大16個のQRコードにまたがってデータを符号化します。このチュートリアルでは詳しく解説しません。|
|FNC1 mode||QRコードをGS1バーコードとして機能させることができます。このチュートリアルでは詳しく解説しません。|

# 漢字モードについての注意
一部のQRコードスキャナはバイトモードでUTF-8が使用されていることを認識することができます。
Shift-JIS文字は全てUTF-8表現を持っており、UTF-8で符号化された漢字のバイトモードを使用可能です。
しかし、UTF-8の漢字は3バイトに符号化されます。(レアケースですが4バイトの可能性もあります。)
一方、Shift-JISの文字は1バイト、または2バイトに符号化されます。
言い換えると、バイトモードでUTF-8の漢字が使用されている場合、できるだけ多くの文字をQRコードに入れるのは不可能です。
Shift-JISの漢字に漢字モードを使用すると最も高い容量が得られます。
したがって、ユーザーの要求に応えて漢字に漢字モードを使用するかはあなた次第です。

# UTF-8についての注意
一部のQRコードスキャナはUTF-8がバイトモードで使用されていることを自動的に検出します。
しかし、バイトモードで使用されているUTF-8の不正な文字を表示しない可能性があります。
これを解決するために、ECIモードが使用できるかもしれません。
上述のとおり、バイトモードでデフォルトのISO-8859-1から違う文字セットをすることが可能です。
しかし、残念ながら全てのQRコードスキャナがECIモードをサポートしているわけではありません。

別のオプションとして、入力文字列の前にUTF-8バイトオーダーマーク(BOM)を設置する手段があります。
一部のQRコードスキャナはBOMを読み取り、そのテキストがUTF-8で符号化されていることを理解します。
しかし、全てのQRコードスキャナが正しくBOMを解釈できるわけではありません。

UTF-8のBOMは3つの数字の組で構成されます。
16進数表現で表すと『0xEF 0xBB 0xBF』になります。

# 最も効率的なモードの選択方法
QRコードの最も効率的なモードを選択するために、次に挙げる条件について
入力された文字列中の文字を調査します。

1. 入力文字列が10進数文字列のみで構成されている場合、Numeric modeを使用します。
2. Numeric modeに該当せず、入力文字列が全てalphanumeric table中に存在する場合、alphanumeric modeを使用します。英小文字は符号化できません。大文字のみです。
3. alphanumeric modeに該当しないが、ISO-8859-1で符号化できる場合、byte modeを使用します。上述のとおり、QRコードスキャナはバイトモードで使用されるUTF-8を認識できる可能性があります。
4. 全ての文字がShift-JIS文字の場合、Kanji modeを使用します。Shift-JIS文字は代わりにUTF-8で符号化できます。漢字をバイトモードで使用することもできます。しかし、一般的にはShift-JISを使用し、漢字に漢字モードを使用することがより効率的です。

# 複合モードと最適化
そのモードを使用する各バイトのセクションの前にモードインジケータを含めることによって単一のQRコードで複数のモードが使用可能です。
QRコードの仕様はモードの最も効率的な切り替え方法を説明しています。このチュートリアルでは詳しく説明しませんが、あとで詳細情報を掲載します。

# サマリー
入力テキストの文字を調査することによって、テキストを符号化するもっとも効率的なモードを選択することができます。
モードを選択する再、QRコードスキャナの制限を考慮することを確認し、全てのQRコードスキャナが標準に則っているわけではないことに注意してください。
さらに、漢字モードかバイトモードでUTF-8を使用するか決断するときはユーザーの要求を考慮してください。

# 次のステップ
符号化モードを選択したら、データを符号化します。
